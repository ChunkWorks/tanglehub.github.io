<!DOCTYPE html>

<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Integrating Freighter WASM in a webpage.txt</title><link rel="stylesheet" type="text/css" href="../styles/main.css" /><script type="text/javascript" src="../styles/main.js"></script><script type="text/javascript">NDLoader.LoadJS("Content", "../styles/");</script></head>

<!-- Generated by Natural Docs, version 2.2 -->

<!-- saved from url=(0016)http://localhost -->

<body onload="NDLoader.OnLoad('Content');" class="NDPage NDContentPage">

<a name="Integrating_Freighter_WASM_in_a_Webpage"></a><a name="Topic1"></a><div class="CTopic TSection LTextFile first">
 <div class="CTitle">Integrating Freighter WASM in a Webpage</div>
 <div class="CBody"><p>This tutorial will guide about integrating Freighter WASM Package in a web application. We will see how we can use Freighter WASM in simple HTML files as well as in a JS Framework application. We will use React framework for an example here.</p></div>
</div>

<a name="Getting_Started"></a><a name="Topic10"></a><div class="CTopic TSection LTextFile">
 <div class="CTitle">Getting Started</div>
 <div class="CBody"><p>In order to start using Freighter WASM, we will need to <a href="https://github.com/Tanglehub/pipe-monorepo/releases?q=Freighter" target="_top">Download Freighter WASM Package</a>. Pre-Compiled Freighter wasm is available for two targets i.e., <b>bundler</b> and <b>no-modules</b>.</p><p>Besides these, Freighter can be compiled from source code for two more targets i.e., <b>nodejs</b> and <b>web</b> by running <b>wasm-pack build --target TARGET_NAME</b> in <b>pipe-monorepo/freighter/freighter-wasm/</b>.</p><p>You can also <a href="https://rustwasm.github.io/docs/wasm-pack/commands/build.html#target/" target="_top">read more about these targets</a>.</p><p>For this tutorial we are using <b>No Modules</b> target. You can check example of using <a href="https://rustwasm.github.io/docs/wasm-bindgen/examples/hello-world.html/" target="_top">bunder target</a>, <a href="https://github.com/rustwasm/wasm-bindgen/tree/main/examples/without-a-bundler/" target="_top">web target</a>, or <a href="https://rustwasm.github.io/docs/wasm-bindgen/reference/deployment.html#nodejs/" target="_top">nodejs target</a>.</p><p>Extract the downloaded package which will extract into a <b>pkg</b> folder. We rename this folder <b>freighter</b> for usage in this guide.</p></div>
</div>

<a name="Using_Freighter_WASM_in_a_HTML_file"></a><a name="Topic3"></a><div class="CTopic TSection LTextFile">
 <div class="CTitle">Using Freighter WASM in a HTML file</div>
 <div class="CBody"><p>Follow the steps below to integrate the extracted freighter folder. Please note that <b>we need to run the html file through a server and not directly</b>. In this example we will use <a href="https://marketplace.visualstudio.com/items?itemName=ritwickdey.LiveServer/" target="_top">VS Code Live Server</a> to open our html file.</p><ul><li><p>Place the extracted freighter folder in same source folder as html file so that folder structure look like below</p></li></ul><pre class="CCode">.<br />├── index.html<br />└── freighter<br />    ├── <span class="SHKeyword">package</span>.json<br />    ├── freighter_iota.js<br />    ├── freighter_iota_bg.wasm.d.ts<br />    ├── freighter_pipe.js<br />    ├── freighter_pipe_bg.wasm.d.ts<br />    ├── freighter_iota.d.ts<br />    ├── freighter_iota_bg.wasm<br />    ├── freighter_pipe.d.ts<br />    └── freighter_pipe_bg.wasm</pre><p>* Add below script tag in HTML <b>head</b> tag</p><pre class="CCode"><span class="SHComment">// If you want to use IOTA API of freighter</span><br />&lt;script src=<span class="SHString">&quot;./freighter/freighter_iota.js&quot;</span> type=<span class="SHString">&quot;text/JavaScript&quot;</span>&gt;&lt;/script&gt;<br /><br /><span class="SHComment">// If you want to use PIPE API of freighter</span><br />&lt;script src=<span class="SHString">&quot;./freighter/freighter_pipe.js&quot;</span> type=<span class="SHString">&quot;text/JavaScript&quot;</span>&gt;&lt;/script&gt;</pre><p>We have successfully integrated Freighter WASM in your application. Now we can call freighter functions by adding a separate <b>script</b> tag in <b>head</b> tag of our as shown below.</p><pre class="CCode">&lt;script&gt;<br />  <span class="SHKeyword">const</span> { Freighter } = wasm_bindgen;<br />  <span class="SHKeyword">function</span> bufferToHex(buffer) {<br />    <span class="SHKeyword">return</span> [...<span class="SHKeyword">new</span> Uint8Array(buffer)]<br />      .map(b =&gt; b.toString(<span class="SHNumber">16</span>).padStart(<span class="SHNumber">2</span>, <span class="SHString">&quot;0&quot;</span>))<br />      .join(<span class="SHString">&quot;&quot;</span>);<br />  }<br />  async <span class="SHKeyword">function</span> run() {<br />    await wasm_bindgen(<span class="SHString">'./freighter/freighter_wasm_bg.wasm'</span>);<br />    <span class="SHKeyword">const</span> seed = <span class="SHKeyword">new</span> Uint8Array(<span class="SHNumber">32</span>)<br />    window.crypto.getRandomValues(seed)<br />    <span class="SHKeyword">const</span> nodeAddress = <span class="SHString">&quot;NODE_ADDRESS_HERE&quot;</span><br />    console.log(<span class="SHString">'Seed:'</span>, seed);<br />    <span class="SHKeyword">const</span> fr = <span class="SHKeyword">new</span> Freighter(nodeAddress, seed)<br />    await fr.init()<br />    let msg = Uint8Array.from(Array.from(<span class="SHString">&quot;Test message&quot;</span>).map(letter =&gt; letter.charCodeAt(<span class="SHNumber">0</span>)))<br />    let msgResult = await fr.sendMessage(msg)<br />    alert(`Freighter WASM message sent successfully! msgid: ${bufferToHex(msgResult)}`)<br />    let frHistory = fr.getChannelHistory(<span class="SHNumber">5</span>)<br />    console.log(<span class="SHString">'frHistory'</span>, frHistory)<br />    let messages = await fr.<span class="SHKeyword">next</span>(frHistory)<br />    alert(messages.map((message) =&gt; {<br />      <span class="SHKeyword">return</span> String.fromCharCode.apply(<span class="SHKeyword">null</span>, message)<br />    }).join(<span class="SHString">&quot;\n&quot;</span>))<br />    <span class="SHComment">// After we are done with the channel history, free the history object</span><br />    frHistory.free()<br />  }<br /><br />  run();<br />&lt;/script&gt;</pre></div>
</div>

<a name="Using_Freighter_WASM_in_ReactJS"></a><a name="Topic4"></a><div class="CTopic TSection LTextFile last">
 <div class="CTitle">Using Freighter WASM in ReactJS</div>
 <div class="CBody"><ul><li><p>In order to use Freighter WASM Package in a React application we need to place the extracted freighter folder in <b>public</b> folder of the application, so that the directory structure looks like below.</p><ul><li><p>React-App-Main-Folder</p><ul><li><p>src</p></li><li><p>freighter</p><ul><li><p>freighter_wasm_bg.js</p></li><li><p>freighter_wasm_bg.wasm</p></li><li><p>freighter_wasm_bg.wasm.d.ts</p></li><li><p>freighter_wasm.d.ts</p></li><li><p>freighter_wasm.js</p></li><li><p>package.json</p></li><li><p>README.md</p></li></ul></li><li><p>package.json</p></li></ul></li></ul></li><li><p>Add below script tag in <b>public/index.html head</b> tag</p></li></ul><pre class="CCode">&lt;script src=<span class="SHString">&quot;%PUBLIC_URL%/freighter/freighter_wasm.js&quot;</span> type=<span class="SHString">&quot;text/JavaScript&quot;</span>&gt;&lt;/script&gt;</pre><ul><li><p>At this point we have successfully integrated Freighter WASM in our React Application. Now we can define a function in our application to use Freighter Public Channel as descripbed below.</p></li></ul><pre class="CCode"><span class="SHComment">/*global wasm_bindgen, a*/</span><br /><span class="SHKeyword">const</span> { Freighter } = wasm_bindgen;<br />await wasm_bindgen(<span class="SHString">'/freighter/freighter_wasm_bg.wasm'</span>);<br /><span class="SHKeyword">const</span> seed = <span class="SHKeyword">new</span> Uint8Array(<span class="SHNumber">32</span>);<br />window.crypto.getRandomValues(seed);<br />let msg = <span class="SHString">&quot;Hello Freighter&quot;</span>;<br /><span class="SHKeyword">const</span> nodeAddress = <span class="SHString">&quot;NODE_ADDRESS_HERE&quot;</span>;<br />let fr = <span class="SHKeyword">new</span> Freighter(nodeAddress, seed);<br />await fr.init();<br />console.log(<span class="SHString">&quot;Freighter Initialized&quot;</span>);<br />let msg = Uint8Array.from(Array.from(message).map(letter =&gt; letter.charCodeAt(<span class="SHNumber">0</span>)));<br />let msgResult = await fr.sendMessage(msg);<br />console.log(`Freighter WASM message sent successfully! msgid: ${bufferToHex(msgResult)}`);</pre></div>
</div>

</body></html>