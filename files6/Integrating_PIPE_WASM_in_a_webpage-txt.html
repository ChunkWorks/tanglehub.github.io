<!DOCTYPE html>

<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Integrating PIPE WASM in a webpage.txt</title><link rel="stylesheet" type="text/css" href="../styles/main.css" /><script type="text/javascript" src="../styles/main.js"></script><script type="text/javascript">NDLoader.LoadJS("Content", "../styles/");</script></head>

<!-- Generated by Natural Docs, version 2.2 -->

<!-- saved from url=(0016)http://localhost -->

<body onload="NDLoader.OnLoad('Content');" class="NDPage NDContentPage">

<a name="Integrating_PIPE_WASM_in_a_Webpage"></a><a name="Topic7"></a><div class="CTopic TSection LTextFile first">
 <div class="CTitle">Integrating PIPE WASM in a Webpage</div>
 <div class="CBody"><p>This tutorial will guide about integrating PIPE WASM Package in a web application. We will see how we can use PIPE WASM in simple HTML files as well as in a JS Framework application. We will use React framework for an example here.</p></div>
</div>

<a name="Getting_Started"></a><a name="Topic2"></a><div class="CTopic TSection LTextFile">
 <div class="CTitle">Getting Started</div>
 <div class="CBody"><p>In order to start using PIPE WASM, we will need to <a href="https://github.com/Tanglehub/pipe-monorepo/releases?q=PIPE/" target="_top">Download Latest PIPE WASM Package</a>. Pre-Compiled PIPE wasm is available for two targets i.e., <b>bundler</b> and <b>no-modules</b>.</p><p>Besides these, PIPE can be compiled from source code for two more targets i.e., <b>nodejs</b> and <b>web</b> by running <b>wasm-pack build --target TARGET_NAME</b> in <b>pipe-rs</b> folder inside <b>pipe-monorepo</b>.</p><p>You can also <a href="https://rustwasm.github.io/docs/wasm-pack/commands/build.html#target/" target="_top">read more about these targets</a>.</p><p>For this tutorial we are using <b>No Modules</b> target. You can check example of using <a href="https://rustwasm.github.io/docs/wasm-bindgen/examples/hello-world.html/" target="_top">bunder target</a>, <a href="https://github.com/rustwasm/wasm-bindgen/tree/main/examples/without-a-bundler/" target="_top">web target</a>, or <a href="https://rustwasm.github.io/docs/wasm-bindgen/reference/deployment.html#nodejs/" target="_top">nodejs target</a>.</p><p>Extract the downloaded package which will extract into a <b>pkg</b> folder. We rename this folder <b>pipe</b> for usage in this guide.</p></div>
</div>

<a name="Using_PIPE_WASM_in_an_HTML_file"></a><a name="Topic47"></a><div class="CTopic TSection LTextFile last">
 <div class="CTitle">Using PIPE WASM in an HTML file</div>
 <div class="CBody"><p>Follow the steps below to integrate the extracted pipe folder. Please note that <b>we need to run the html file through a server and not directly</b>. In this example we will use <a href="https://marketplace.visualstudio.com/items?itemName=ritwickdey.LiveServer/" target="_top">VS Code Live Server</a> to open our html file.</p><ul><li><p>Place the extracted pipe folder in same source folder as html file so that folder structure look like below</p></li></ul><pre class="CCode">.<br />├── index.html<br />└── pipe<br />    ├── <span class="SHKeyword">package</span>.json<br />    ├── pipe_rs_bg.js<br />    ├── pipe_rs_bg.wasm<br />    ├── pipe_rs_bg.wasm.d.ts<br />    ├── pipe_rs.d.ts<br />    └── pipe_rs.js</pre><ul><li><p>Load the JavaScript code</p></li></ul><pre class="CCode">&lt;script src=<span class="SHString">&quot;./pipe/pipe_rs.js&quot;</span> type=<span class="SHString">&quot;text/JavaScript&quot;</span>&gt;&lt;/script&gt;</pre><p>We have successfully integrated PIPE WASM in your application. Now we can call pipe functions by adding a separate <b>script</b> tag in <b>head</b> tag of our as shown below.</p><pre class="CCode">&lt;script&gt;<br />  <span class="SHKeyword">const</span> { Pipe } = wasm_bindgen;<br />  async <span class="SHKeyword">function</span> run() {<br />    await wasm_bindgen(<span class="SHString">'/pipe/pipe_rs_bg.wasm'</span>);<br />    console.log(<span class="SHString">&quot;PIPE buildInfo&quot;</span>, JSON.stringify(Pipe.getInfo(), <span class="SHKeyword">null</span>, <span class="SHNumber">2</span>));<br />    <span class="SHKeyword">const</span> seed = <span class="SHKeyword">new</span> Uint8Array(<span class="SHNumber">32</span>);<br />    window.crypto.getRandomValues(seed);<br />    let pipe = <span class="SHKeyword">new</span> Pipe(seed);<br />    <span class="SHComment">// For custom node / network</span><br />    pipe.overrideBootstrap([<br />      <span class="SHString">&quot;xejsAM3IrzZ0r9q64hHS_TWArQvLOrMU_M53uod9_taA9zxSXxZQtoLukfHl6kRo@135.181.147.112:13267~xejsam3irzz0r9q6.ion.ooo&quot;</span><br />    ]);<br />    pipe.overrideBootstrap();<br />    await pipe.init();<br />    <span class="SHComment">// Random message tag and data</span><br />    <span class="SHKeyword">const</span> msgTag = <span class="SHKeyword">new</span> Uint8Array(<span class="SHNumber">32</span>);<br />    window.crypto.getRandomValues(msgTag);<br />    <span class="SHKeyword">const</span> msgBytes = <span class="SHKeyword">new</span> Uint8Array(<span class="SHNumber">128</span>);<br />    window.crypto.getRandomValues(msgBytes);<br />    await pipe.storeChunk(msgBytes, msgTag);<br />    <span class="SHComment">// Read it back</span><br />    let chunks = await pipe.getChunksByTag(msgTag);<br />    console.log(<span class="SHString">&quot;Chunks!&quot;</span>, chunks);<br />  }<br />  run()<br />&lt;/script&gt;</pre><div class="CHeading">Full Example</div><pre class="CCode">&lt;html&gt;<br />  &lt;head&gt;<br />    &lt;meta content=<span class="SHString">&quot;text/html;charset=utf-8&quot;</span> http-equiv=<span class="SHString">&quot;Content-Type&quot;</span> /&gt;<br />  &lt;/head&gt;<br />  &lt;script src=<span class="SHString">&quot;pipe/pipe_rs.js&quot;</span>&gt;&lt;/script&gt;<br />  &lt;script&gt;<br />    <span class="SHKeyword">const</span> { Pipe } = wasm_bindgen;<br />    <span class="SHKeyword">const</span> hexToBuffer = (hexString) =&gt;<br />      <span class="SHKeyword">new</span> Uint8Array(<br />        hexString.match(/.{<span class="SHNumber">1</span>,<span class="SHNumber">2</span>}/g).map((<span class="SHKeyword">byte</span>) =&gt; parseInt(<span class="SHKeyword">byte</span>, <span class="SHNumber">16</span>))<br />      );<br /><br />    async <span class="SHKeyword">function</span> wait(ms) {<br />      <span class="SHKeyword">return new</span> Promise((resolve, reject) =&gt; {<br />        setTimeout(resolve, ms);<br />      });<br />    }<br /><br />    async <span class="SHKeyword">function</span> run() {<br />      await wasm_bindgen(<span class="SHString">&quot;/pipe/pipe_rs_bg.wasm&quot;</span>);<br />      console.log(<span class="SHString">&quot;buildInfo&quot;</span>, JSON.stringify(Pipe.getInfo(), <span class="SHKeyword">null</span>, <span class="SHNumber">2</span>));<br />      <span class="SHKeyword">const</span> seed = <span class="SHKeyword">new</span> Uint8Array(<span class="SHNumber">32</span>);<br />      window.crypto.getRandomValues(seed);<br />      let pipe = <span class="SHKeyword">new</span> Pipe(seed);<br />      // For custom node / network<br />      pipe.overrideBootstrap([<br />        <span class="SHString">&quot;xejsAM3IrzZ0r9q64hHS_TWArQvLOrMU_M53uod9_taA9zxSXxZQtoLukfHl6kRo@135.181.147.112:13267~xejsam3irzz0r9q6.ion.ooo&quot;</span>,<br />      ]);<br />      await pipe.init();<br />      <span class="SHKeyword">const</span> msgBytes = hexToBuffer(<span class="SHString">&quot;80085DEEEE&quot;</span>);<br />      <span class="SHKeyword">const</span> msgTag = <span class="SHKeyword">new</span> Uint8Array(<span class="SHNumber">32</span>);<br />      window.crypto.getRandomValues(msgTag);<br />      console.log(<span class="SHString">&quot;My tag:&quot;</span>, msgTag);<br />      console.log(<span class="SHString">&quot;Storing chunk after 5 seconds...&quot;</span>);<br />      await pipe.storeChunk(msgBytes, msgTag);<br />      alert(<br />        <span class="SHString">&quot;Random data stored to PIPE. Reading back chunk after 5 seconds...&quot;</span><br />      );<br />      await wait(<span class="SHNumber">5000</span>);<br />      let chunks = await pipe.getChunksByTag(msgTag);<br />      alert(`Fetched the stored Chunks! ${JSON.stringify(chunks)}`);<br />    }<br />    run();<br />  &lt;/script&gt;<br />&lt;/html&gt;</pre></div>
</div>

</body></html>